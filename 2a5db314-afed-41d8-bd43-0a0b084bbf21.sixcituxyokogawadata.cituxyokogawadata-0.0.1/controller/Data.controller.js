sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,a,r,i){"use strict";return e.extend("cit.ux.yokogawadata.controller.Data",{onInit:function(){var e=this.getOwnerComponent().getManifestEntry("/sap.app/id");var t=e.replaceAll(".","/");this.appModulePath=jQuery.sap.getModulePath(t)},onSelectSensors:function(e){var t=e.getSource(),a=false;if(t.getSelectedKey().length>0){a=true}t.data("hasValue",a);this.getView().byId("SensorDataTable").rebindTable()},onBeforeRebindTable:function(e){var t=e.getParameter("bindingParams");if(this.getView().byId("sensors").getSelectedKey().length){t.filters.push(new r("sensor_id",i.EQ,this.getView().byId("sensors").getSelectedKey()));if(t.filters[0].aFilters){var a=t.filters[0].aFilters[0].oValue1;var n=t.filters[0].aFilters[0].oValue2;var s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));var o=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()));t.filters[0].aFilters[0].oValue1=s;t.filters[0].aFilters[0].oValue2=o}this.getView().byId("SensorDataTable").setEntitySet("Sensor_Data_Entity");t.parameters["expand"]="sensor/type"}},onDataPrevExpand:function(e){if(e.getSource().getExpanded()===true){this.getView().byId("SensorDataTable").rebindTable()}},onTypeMismatch:function(e){var t=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");showError("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+t)},_getDocServiceRuntimeBaseURL:function(){var e=this.getOwnerComponent().getManifestEntry("/sap.app/id");var t=e.replaceAll(".","/");var a=jQuery.sap.getModulePath(t);return a},onFileChange:function(e){var t=this.byId("__fileUploader");var a=t.getFocusDomRef();var r=e.getParameter("files")[0];var i=r.name.split(".")[1];var n=new FileReader;var s=this;var o=[];n.onload=async function(e){var t=[];this.content=e.currentTarget.result.split(",")[1];this.createfile(i,this.content)}.bind(this);n.readAsDataURL(r)},createfile:function(e,t){var r=this;var i=this._getDocServiceRuntimeBaseURL();var n=this.content;$.ajax({url:i+"/odata/v2/Sustainability/uploadExcel",method:"POST",async:false,timeout:3e5,data:JSON.stringify({ExcelFile:n,fileType:e}),headers:{"Content-Type":"application/json"},success:function(e,t,i){a.success(e.d.uploadExcel);r.byId("__fileUploader").clear()},error:function(e){a.error("An error occurred. Please try again with properly formatted data.");r.byId("__fileUploader").clear()}})}})});
//# sourceMappingURL=Data.controller.js.map