sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/m/Dialog","sap/m/Text","sap/m/Button","sap/ui/model/odata/v2/ODataModel","sap/ui/model/Sorter"],function(e,t,n,a,i,s,r,o,d){"use strict";var l=["plant","sensor","fuel","SensorTypesData","EquipmentTypesData"];return e.extend("cit.ux.yokogawa.controller.FuelConsumption",{onInit:function(){this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle();this.getOwnerComponent().getRouter().getRoute("MasterData").attachPatternMatched(this._handleRouteMatched,this)},_handleRouteMatched:function(e){if(e.getParameter("arguments").tab){switch(true){case e.getParameter("arguments").tab.startsWith("plant"):this.getView().byId("iconTabBarID").setSelectedKey("plant");this.getView().byId("PlantSmartTable").attachBeforeRebindTable(e.getParameter("arguments").tab,this.addPlantParams,this);break;case e.getParameter("arguments").tab.startsWith("sensor"):this.getView().byId("iconTabBarID").setSelectedKey("sensor");this.getView().byId("MeterSmartTable").attachBeforeRebindTable(e.getParameter("arguments").tab,this.addSensorParams,this);break;default:return}}},addSensorParams:function(e,t){var n=t.match(/'[^']+'/);if(n){this.getView().byId("smartFilterBar").getBasicSearchControl().setValue(n[0].slice(1,-1));e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter("id","EQ",n[0].slice(1,-1)));this.getView().byId("MeterSmartTable").detachBeforeRebindTable(this.addSensorParams,this)}else{return null}},addPlantParams:function(e,t){var n=t.match(/'[^']+'/);if(n){this.getView().byId("smartPlantFilterBar").getBasicSearchControl().setValue(n[0].slice(1,-1));e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter("id","EQ",n[0].slice(1,-1)));this.getView().byId("PlantSmartTable").detachBeforeRebindTable(this.addPlantParams,this)}else{return null}},onTabChange:function(e){var t=e.getParameters().selectedKey;if(t&&t=="plant"||t=="sensor"){this.getOwnerComponent().getRouter().navTo("MasterData",{tab:t},true)}else{this.getOwnerComponent().getRouter().navTo("MasterData",{tab:"others"},true)}},onBeforeRebindSensorRegisterTable:function(e){var t=e.getParameter("bindingParams");t.sorter.push(new d("plant_id"));t.parameters["expand"]="equipment_type,type"},onAddEntry:function(e,t){var n=this._onCreateEntry(t);var i=n.getPath();var s=this.getView();if(!this.byId(e)){a.load({id:s.getId(),name:"cit.ux.yokogawa.view."+e,controller:this}).then(function(e){s.addDependent(e);e.bindElement({path:i});e.open()})}else{this.byId(e).bindElement({path:i});this.byId(e).open()}},_onCreateEntry:function(e){var n;switch(e){case"Plant_Info_Entity":n={id:"000",desc:"",address:"",city:"",region:"",country:"",postcode:"",lattitude:"",longitude:""};break;case"Fuel_Category_Entity":n={type:"000",desc:"",carbon_emission_value:0,unit:"gram",is_renewable:false};break;case"Sensor_Types_Entity":n={id:"000",desc:"",unit:""};break;case"Equipment_type_Entity":n={id:"000",desc:""};break;case"Sensor_Data_Entity":n={timestamp:"",createdAt:"/Date(1703151595031+0000)/",createdBy:"",modifiedAt:"/Date(1703151595031+0000)/",modifiedBy:"",sensor_id:"",reading:""};break;case"Sensor_Register_Entity":n={id:"000",equipment_no:"",equipment_type_id:"",type_id:"",plant_id:"",fuel_type:"",status:"",threshold_limit:null,lower_threshold_isactive:false,upper_threshold_isactive:false,lower_threshold_limit:null,upper_threshold_limit:null,create_maintainance_order:null};break;default:t.show("Something went wrong!");return}var a=this.getView().getModel().createEntry("/"+e,{properties:n});return a},onCancelDialogAdd:function(e){this.getView().getModel().resetChanges();this.byId(e).close()},onEntryEdit:function(e,t){var n=this.getView();if(!this.byId(t)){a.load({id:n.getId(),name:"cit.ux.yokogawa.view."+t,controller:this}).then(function(t){n.addDependent(t);t.bindElement({path:e.getSource().getBindingContext().getPath()});t.open()})}else{this.byId(t).bindElement({path:e.getSource().getBindingContext().getPath()});this.byId(t).open()}},onUpdateEntry:function(e){var n=this;this.getView().getModel().submitChanges({success:function(a){t.show(n.oBundle.getText("UpdateSuccess"));n.getView().getModel().refresh();n.getView().getModel().resetChanges();n.byId(e).close()},error:function(e){t.show("Failed")}})},onCancelDialogUpdate:function(e){this.getView().getModel().resetChanges();this.byId(e).close()},onEntryDelete:function(e){var n=this;var a=this.getOwnerComponent().getModel();this.sPath=e.getSource().getBindingContext().getPath();var o=new i({title:n.getView().getModel("i18n").getResourceBundle().getText("Confirm"),type:"Message",content:new s({text:n.getView().getModel("i18n").getResourceBundle().getText("AreYouSureYouWantToDeleteThisRecord")}),beginButton:new r({text:n.getView().getModel("i18n").getResourceBundle().getText("Submit"),press:function(){a.remove(n.sPath,{success:function(){t.show(n.getView().getModel("i18n").getResourceBundle().getText("RecordDeletedSuccessfully"));n.getView().getModel().refresh()},error:function(e){t.show(n.getView().getModel("i18n").getResourceBundle().getText("DeleteFailed"))}});o.close()}}),endButton:new r({text:n.getView().getModel("i18n").getResourceBundle().getText("Cancel"),press:function(){o.close()}}),afterClose:function(){o.destroy()}});o.open()},onSelectLimit:function(e,t){if(!e.getParameter("selected")){this.getView().getModel().setProperty(e.getSource().getBindingContext().getPath()+"/"+t,null)}}})});
//# sourceMappingURL=FuelConsumption.controller.js.map